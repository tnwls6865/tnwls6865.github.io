---
layout: post
title:  "PUZZLE-CAM: IMPROVED LOCALIZATION VIA MATCHING PARTIAL AND FULL FEATURES"
date:   2021-04-20 15:42:36 +0530
categories: paper

---



ë…¼ë¬¸ ê¾¸ì¤€íˆ ì•ˆ ì½ì€..ê²Œìœ¼ë¥¸ ì‚¬ëŒğŸ™„ğŸ™„



ê·¸ë™ì•ˆ ì½ê³  ì •ë¦¬ ì•ˆí–ˆë˜ê±° ì°¨ê·¼ì°¨ê·¼ ì •ë¦¬ì¤‘..ğŸ˜¹ğŸ˜¹

### Abstract

Weakly-supervised semantic segmentation(WSSS)ì—ì„œ ê¸°ì¡´ ë°©ë²•ë“¤ì€ CAM(class activation map)ì„ í™œìš©í•˜ì—¬ pseudo-labelì„ ë§Œë“¤ì—ˆì§€ë§Œ ì´ëŸ¬í•œ ê³¼ì •ì€ ì£¼ë¡œ objectì˜ ê°€ì¥ discriminative partì—ë§Œ ì§‘ì¤‘í•¨ ê·¸ë˜ì„œ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” Puzzle-CAMì„ ì œì•ˆí•¨ ì´ëŠ” ì „ì²´ ì´ë¯¸ì§€ì™€ seperate patchë¡œë¶€í„°ì˜ feature ê°„ì˜ ì°¨ì´ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê³¼ì •ì„ ê°€ì§€ê³  ìˆìŒ ì œì•ˆí•œ methodëŠ” ë‘ê°œì˜ regulairzation termì„ í†µí•´ì„œ objectì—ì„œ ê°€ì¥ integerated regionì„ ë°œê²¬í•˜ê³  ì¶”ê°€ì ì¸ parameterì—†ì´ image-level supervision ì„ ì‚¬ìš©í•´ì„œ ì „ì²´ì ì¸ regionì„ í™œì„±í™” í•  ìˆ˜ ìˆìŒ



### Introduction

FSSS(Fully-supervised semantic segmentation)ì€ pixel levelë¡œ ë°ì´í„°ì…‹ì„ ë§Œë“¤ê¸°ë•Œë¬¸ì— ë°ì´í„°ì…‹ì„ êµ¬ì¶•í•˜ëŠ”ë° ë”ë¬´ ë¹„ì‹¸ê¸° ë•Œë¬¸ì— image-levelì˜ annotationì„ í™œìš©í•¨ ì˜ˆë¥¼ ë“¤ì–´ bbox, scribble ë“±ë“±ì„ í™œìš©í•œ WSSS(Weakly supervised semantic segmentation)ê³¼ ê´€ë ¨í•´ì„œ ë§ì€ ì—°êµ¬ê°€ ì§„í–‰ë¨   

WSSS w/ CAMì€ íš¨ìœ¨ì ìœ¼ë¡œ ë¶„ë¥˜í•˜ê¸° ìœ„í•´ì„œ  object ì‘ì€ ë¶€ë¶„ì— ì´ˆì ì„ ë§ì¶”ê¸° ë•Œë¬¸ì— segmentation ëª¨ë¸ì´ í”½ì…€ìˆ˜ì¤€ì˜ ì •ë³´ë¥¼ í•™ìŠµí•  ìˆ˜ ì—†ìŒ ê·¸ë¦¬ê³  CAMì€ ì´ë¯¸ì§€ì— ë”°ë¼ ë‹¤ë¥´ê²Œ ê²°ê³¼ë¥¼ ìƒì„±í•¨   
![img1](/assets/post/post14/img1.png)

tile imageì™€ original imageì— ëŒ€í•œ CAMì„ reconstructionì„ ì‚¬ìš©í•´ì„œ self-supervisionìœ¼ë¡œ í•˜ëŠ” Puzzle CAM moduleì œì•ˆ 

* ì¶”ê°€ì  layerì—†ì´ CAMì˜ qualityë¥¼ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ reconstructing regularization ì„ í¬í•¨í•œ Puzzle-CAMì„ ì œì•ˆ
* Puzzle-CAM outputformed existing state-of-the-art

### Related Work

1. Attnetion Mechanisms Using CNN  
   ê¸°ì¡´ ì—°êµ¬ë“¤ì€ semantic ì§€ì—­ì„ ì‹œê°í™” í•˜ê¸° ìœ„í•´ì„œ error backpropagation with GAPë¥¼ ì‚¬ìš©ê±°ë‚˜ attention mapì„ ìƒì„±í•˜ì˜€ì§€ë§Œ WSSSì—ì„œëŠ” attentionì€ ì¢‹ì€ ì„±ëŠ¥ì„ ë³´ì´ì§€ ëª»í•¨ 
2. Weakly Supervised Semantic Segmentation   
   ê¸°ì¡´ì—ëŠ” CAMì„ ì‚¬ìš©í•´ì„œ segmentation maskë¥¼ ê·¼ì‚¬ í•˜ê±°ë‚˜ AffinityNetì€ í”½ì…€ê°„ì˜ similarityë¥¼ êµ¬í•˜ê¸° ìœ„í•œ ì¶”ê°€ì  networkë¥¼ ì‚¬ìš©í•˜ì˜€ìŒ IRNetì€ boundary activation mapì—ì„œ transition matrixì„ ìƒì„±í•˜ëŠ” ë“±ê³¼ ê°™ì´ WSSSê°€ ë§ì´ ì—°êµ¬ ë˜ì–´ì¡ŒìŒ 

### Method

![img2](/assets/post/post15/img2.png)

* Motivation  
  ëŒ€ë¶€ë¶„  CAM based WSSSëŠ” image-level supervisionì„ í™œìš©í•´ì„œ  segmentation maskë¥¼ ì–»ìŒ ê·¸ë˜ì„œ ëŒ€ë‘ë¶€ë¶„ CAmì€ objectì˜ discriminativeí•œ ì˜ì—­ì— focuseí•¨ ê·¸ë¦¬ê³  ì´ëŠ” classification lossë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— partial region ì´ ìƒê¸´ë‹¤. tiled imageë¡œ ë¶€í„° ìƒì„±ëœ CAmì€ global-context informationì„ ê°–ê³  ìˆì§€ ì•Šê¸°ë•Œë¬¸ì— over-activationì„ ìœ ë°œí•¨ ì´ëŸ¬í•œ ë¬¸ì œë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ”  original imageì™€ tiled imageë¡œ ë¶€í„° camì„ ìƒì„±í•˜ê³   matchí•˜ëŠ” loss functionì„ í¬í•¨í•˜ëŠ” puzzle CAMì„ ì œì•ˆí•¨ ì´ puzzle CAMì€ partial ì™€ full featrueë¥¼ ë§¤ì¹˜ì‹œí‚¤ë©´ì„œ prediction ì¼ê´€ì„±ì„ ê°œì„ í•¨ 
* The Employed CAM Method  
  initial attention mapì„ ìƒì„±í•˜ê¸°ìœ„í•´ì„œ CAM methodë¥¼ ì‚¬ìš©í•¨     
  FëŠ” feature extractor, ì„¸íƒ€ëŠ” classifierê°€ ì£¼ì–´ì¡Œì„ ë•Œ ëª¨ë“  classì— ëŒ€í•´ì„œ CAMì„ ìƒì„±í•¨ í•™ìŠµí›„ì—, feature mapì—ì„œ c-channel classifierì˜ weight ë¥¼ ì‚¬ìš©í•˜ì—¬ class cì— ëŒ€í•´ì„œ CAMì„ ë‹¤ìŒê³¼ ê°™ì´ ì–»ìŒ   
  ![img3](/assets/post/post15/img3.png)  
  ìƒì„±ëœ A_cì˜ maximum valueë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ëœ CAMì„ normalizeí•¨ 
* The Puzzle Module   
  partial and full featureì˜ matching ì‹œí‚¬ ë•Œ keyëŠ” FSSSì™€ WSSSê°„ì˜ gapì„ ì¤„ì´ëŠ”ê²ƒì„ puzzle moduleì€ tilingì´ë‘ merging moduleë¡œ êµ¬ì„±ë˜ì–´ìˆìŒ overlappingì—†ì´ ![img4](/assets/post/post15/img4.png)  
  ê·¸ë¦¬ê³  ê° ìœ„ì¹˜ì—ì„œ CAMì„ ìƒì„±í•˜ê³  ë‹¤ì‹œ Mergeí•¨ 
* The Loss Design for Puzzle-CAM   
  ë§ˆì§€ë§‰ì— GAP layerë¥¼ ì‚¬ìš©í•˜ì—¬ outputì„ ì¶”ì¶œí•˜ê³  multi-label soft margin lossë¥¼ classificationì„ ìœ„í•´ ì‚¬ìš©í•¨   
  ![img5](/assets/post/post15/img5.png)   
  ê·¸ë¦¬ê³  tile CAMê³¼ original CAMì— ëŒ€í•´ì„œ global average poolingì„ ì ìš©í•˜ê³  ì´ì— ëŒ€í•´ì„œ classification lossë¥¼ ë”í•¨ ì´ëŸ¬í•œ classification lossëŠ”  image classification performanceë¥¼ ê°œì„ í•˜ëŠ”ë° ì‚¬ìš©ë˜ì–´ì§€ê³ , CAMì„ reinforceí•˜ê¸° ìœ„í•´ì„œ reconstruction regularizationì„ ì‚¬ìš©í•¨   
  ![img6](/assets/post/post15/img6.png)   
  ![img7](/assets/post/post15/img7.png)  
  ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìµœì¢… ë¡œìŠ¤ëŠ” ë‹¤ìŒê³¼ ê°™ìŒ  
  ![img8](/assets/post/post15/img8.png)


### Experiments

![img9](/assets/post/post15/img9.png)  
í¥ë¯¸ë¡œì› ë˜ ì‹¤í—˜ê²°ê³¼ 

ê·¸ë¦¬ê³  ì œì•ˆí•œ ë°©ë²•ì´ segmentationì—ì„œë„ ì¢‹ì€ ì„±ëŠ¥ì„ ëƒ„ 

![img10](/assets/post/post15/img10.png)
---
layout: post
title:  "SegNeXt: Rethinking Convolutional Attention Design for Semantic Segmentation ì •ë¦¬"
date:   2022-09-24 10:32:36 +0530
categories: paper
---

ì •ë¦¬ëŠ” ë„˜ ê·€ì°®ë„¹...ğŸ¤¡ğŸ¤¡



Semantic Segmentationì—ì„œ Transformer êµ¬ì¡°ë³´ë‹¤ convolution êµ¬ì¡°ê°€ ë” íš¨ìœ¨ì ì„ì„ ì£¼ì¥
 Semantic Segmentation key properties

* A strong Backbone
* Multi-scale information for objects of varying size
* Spatial attention 
* Low computational complexity 

we rethink the design of convolutional attention and propose an efficient yet effective encoder-decoder architecture 



1. Convolutional Encoder

   * hierarchical pyramid structure ì‚¬ìš© (4/8/16/32) 3x3 stride 2 conv - batch norm  
     (layer normì´ batch normë³´ë‹¤ ì„±ëŠ¥ì´ ì¢‹ìŒ in segmentation)

   * encoderëŠ” ViTêµ¬ì¡°ì™€ ë¹„ìŠ·í•˜ì§€ë§Œ self-attention mechanismì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  novel multi-scale convolutional attention (MSCA) moduleì„ ì œì•ˆí•¨ 

   * three parts

     - local informationì„ aggregateí•˜ëŠ” depth-wise convolution 

     - multi-scale contextë¥¼ í¬ì‘í•˜ëŠ” multi-branch depth-wise strip conv

     - ë‹¤ì–‘í•œ ì±„ë„ê°„ ê´€ê³„ë¥¼ ëª¨ë¸ë§í•˜ëŠ” 1x1 conv 
       ![img1](\assets\post\post25\img1.png)
       ![img2](\assets\post\post25\img2.png)
       $$\otimes$$ is the element-wise matrix multiplication operation
       $$i \in \{0,1,2,3\}$$ denotes the $$i$$ th branch $$Sacle_0$$ is the identity connection 

       each branchì—ì„œ depth-wise conv with large kernel (7, 11, 21)
       lightweightë¥¼ ìœ„í•´ 7x1 1x7í˜•ì‹ìœ¼ë¡œ mimic

2. Decoder
   three simple decoder structure 
   ![img2](\assets\post\post25\img3.png)

   * MLP-based structure

   * CNN-based models

   * SegNeXt
     last three stageë¡œë¶€í„° featuresë¥¼ aggregateí•˜ê³  lightweight Hamburgerëª¨ë¸ ì‚¬ìš©

     



ê¸°ì¡´ì˜ ë°©ë²•ì€ í•œë²ˆì— ëª¨ë“  ì˜¤ë¸Œì íŠ¸ ì¹´í…Œê³ ë¦¬ì— ëŒ€í•´ classifierë¥¼ ì§„í–‰í•¨ í•˜ì§€ë§Œ ì´ëŠ” ë¹„ìŠ·í•œ ì¹´í…Œê³ ë¦¬ì— ëŒ€í•´ êµ¬ë³„í•˜ê¸° ì–´ë ¤ì›€ 
ê¸°ì¡´ì˜ ë°©ë²•ê³¼ëŠ” ë‹¤ë¥´ê²Œ 1) confusing categoryì— ëŒ€í•´ êµ¬ë³„í•˜ê¸° ìœ„í•´ì„œ general classifier + refinement classifier = integrated classifierë¥¼ ì‚¬ìš©í•¨ 2) confusing categoryì— ëŒ€í•´ scoreê°€ ê·¼ì ‘í•˜ì—¬ misclassificationì´ ì´ë£¨ì–´ì§ˆ ìˆ˜ ìˆê³  ì´ì— ëŒ€í•´ variance-based regularizationì„ ì œì•ˆí•¨ 

ì œì•ˆí•˜ëŠ” ë°©ë²•ì€ ë‹¤ìŒê³¼ ê°™ì´ 3ë‹¨ê³„ë¡œ ì´ë£¨ì–´ì ¸ìˆìŒ

![img1](\assets\post\post24\img1.png)

**goal** 
$$\hat{c} = argmax_c P(O = o_c | I, r)$$

**1) feature extractor**
**2) general classification**

![img2](\assets\post\post24\img2.png)

multiple binary classifier  ë¥¼ ì‚¬ìš©í•˜ëŠ” ì´ìœ ëŠ” ìœ„ì˜ ê·¸ë¦¼(ì˜¤ë¥¸ìª½)ê³¼ ê°™ìŒ 
ì¼ë°˜ì ì¸ classifierëŠ” ë¹„ìŠ·í•œ ì¹´í…Œê³ ë¦¬ë¼ë¦¬ë¼ë„ ì°¨ì´ê°€ ë§ì´ ë‚¨ 
ë°˜ëŒ€ë¡œ ì˜¤ë¥¸ìª½ ê°™ì€ binaryì˜ ê²½ìš°ëŠ” ì°¨ì´ê°€ ë³„ë¡œ ë‚˜ì§€ ì•ŠìŒ ì´ëŠ” multinomial ë³´ë‹¤ ìƒëŒ€ì ìœ¼ë¡œ ë†’ì€ scoreë¥¼ ì œê³µí•¨ ê·¸ë˜ì„œ binary classifierë¥¼ ì‚¬ìš© 

**3) refine classification**

multinomial classifierë¥¼ ì‚¬ìš©í•¨ Iì™€ general classifierì˜ probì„ inputìœ¼ë¡œ ì‚¬ìš© 
general classifierì— ë†’ì€ probì— ëŒ€í•´ categoryë¥¼ êµ¬ë¶„í•˜ê³ , general classifierì˜ ì˜¤ë¥˜ ë°©ì§€ì— ì¤‘ì  



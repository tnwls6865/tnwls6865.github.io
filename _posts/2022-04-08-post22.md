---
layout: post
title:  "CANet: Class-Agnostic Segmentation Networks with Iterative Refinement and Attentive Few-Shot Learning ì •ë¦¬"
date:   2022-04-08 10:32:36 +0530
categories: paper
---

ìš”ì¦˜ ë‚ ì”¨ ë„˜ ì¢‹ë‹¤,, ì˜¤ëŠ˜ë„ ë…¼ë¬¸ í•˜ë‚˜ ì½ì–´ì•¼ì§€ğŸŒ·ğŸŒ·  
ì ì  ì •ë¦¬ê°€ ëŠ¦ì–´ì§€ê³  ìˆëŠ”ê±´ ë¹„ë°€ 



![img1](\assets\post\post22\img1.png)

ê¸°ì¡´ ë°©ë²•ë“¤ì€ two branchë¡œ ì´ë£¨ì–´ì ¸ì„œ support branchëŠ” query imageì˜ segmentë¥¼ guidance í•˜ê¸° ìœ„í•´ featureë¥¼ extracting í•¨ 

ì œì•ˆí•˜ëŠ” ë°©ë²•ë„ ë§ˆì°¬ê°€ì§€ë¡œ two branch designì„ ì‚¬ìš© 

* dense comparison module 
  ê¸°ì¡´ pixel-levelë¡œ ë¹„êµí•˜ëŠ” ë°©ë²•ë“¤ì€ metric learningì„ í•˜ë ¤ë©´ computational costê°€ ë†’ì•˜ìŒ. ì œì•ˆí•˜ëŠ” ë°©ë²•ì€ global average poolingì„ í†µí•´ dense featureë¥¼ ì¶”ì¶œí•˜ê³  computational costë„ ì¤„ì¸ ìƒíƒœì—ì„œ metric learningì„ í•  ìˆ˜ ìˆìŒ 

  * feature extract branch
    unseen classesì˜ íŠ¹ì§•ì„ ì¶”ì¶œí•˜ê¸° ìœ„í•´ high-levelì´ ì•„ë‹Œ middle-level layerë¥¼ ì¶”ì¶œí•˜ì—¬ í•™ìŠµ
  * dense Comparison
    imageì— target objectì™€ backgroundê°€ ê°™ì´ ìˆê¸° ë•Œë¬¸ì—, global average poolingì„ í†µí•´ foreground featureë¥¼ squeezeí•¨ 
    query branchë¡œë¶€í„° ìƒì„±ëœ feature mapì—ì„œì˜ spatial locationê³¼ support setì˜ foreground feature vectorë¥¼ concatí•¨(foregroundì˜ì—­ë§Œ ì¶”ì¶œí•˜ê¸° ìœ„í•´ binary support maskë‘ element-wise multiplication)

* iterative optimization module 
  dense featureë¥¼ comparisoní•˜ëŠ” ê²ƒì€ ì¶©ë¶„í•˜ì§€ ì•Šì•„ iteratively refineí•˜ëŠ” optimization moduleì„ ì œì•ˆ 
  residual connection structureë¥¼ ì‚¬ìš©í•˜ì—¬ í•™ìŠµì„ íš¨ìœ¨ì ìœ¼ë¡œ í•¨ 
  input : dense comparisonì„ í†µí•´ ìƒì„±ëœ feature map, last iterationì—ì„œì˜ predict mask
  first forward passì—ì„œëŠ” prediction maskê°€ ì—†ì–´ì„œ directë¡œ ì‚¬ìš©ì„ ëª»í•¨
  ê·¸ë˜ì„œ residual formì„ í™œìš©í•˜ì—¬ prediction maskë¥¼ í™œìš©
  $$M_t = x + F(x, y_{t-1})$$
  $$x$$ : output feature of the dense comparison module
  $$y_{t-1}$$ : prediction mask from the last iteration step
  $$M_t$$ : output of the residual block
  $$F()$$ : two 3x3 conv with 256 filter ë¥¼ í†µí•´  ë‘ ê°œì˜ feature ë¥¼ concat
  ë§ˆì§€ë§‰ì—ì„œëŠ” Atrous Spatial Pyramid Pooling Moudleì„ í™œìš© 
  dropoutì—ì„œ ì˜ê°ì„ ë°›ì•„ IOMì˜ inputìœ¼ë¡œ alternatively last epochì˜ prediction maskë‘ empty maskë¥¼ ì‚¬ìš©

* attention module

  ![img2](\assets\post\post22\img2.png)  
  multiple support exampleë¡œ ë¶€í„° informationì„ í™œìš©í•˜ê¸° ìœ„í•´ attention moduleì‚¬ìš© 
  two conv block 256 3x3 filter -> 3x3 max pooling -> 256 3x3 filter -> global average pooling 
  weight $$\lambda$$ ìƒì„± 
  $$\hat \lambda = {e^{\lambda_i} \over \sum_{j=1}^{k}e^{\lambda_j}}$$
  final output : ë‹¤ì–‘í•œ support sampleì— ì˜í•´ ìƒì„±ëœ featureì˜ weighted sum 


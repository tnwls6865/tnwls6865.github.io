---
layout: post
title:  "SG-One: Similarity Guidance Network for One-Shot Semantic Segmentation"
date:   2022-04-06 10:32:36 +0530
categories: paper
---

ê°„ë§Œì— ë„ì „í•˜ëŠ” 1ì¼ 1ë…¼ë¬¸ 1ì •ë¦¬ ğŸ˜µğŸ˜µ
ë„ˆë¬´ ë‚ ì”¨ ì¢‹ì•„ì„œ ê³µë¶€í•˜ê¸° ì‹«ì€ ë‚ ,,  

  


![img1](\assets\post\post21\img1.png)

masked average poolingì„ í™œìš©í•˜ì—¬ support imageì— ëŒ€í•´ì„œ  guidance featureë¥¼ ìƒì„±í•¨. ê·¸ë¦¬ê³  query imageë¡œë¶€í„° pixel featureì™€ guidance feature ê°„ì— relationshipì„ buildingí•˜ê¸° ìœ„í•´ cosine similarityë¥¼ í™œìš©.
ì´ëŸ¬í•œ ë°©ì‹ìœ¼ë¡œ ìƒì„±ëœ similarity mapì˜ possibilities embeddedëŠ” segmenting objectì˜ processë¥¼ ì¡°ì ˆí•  ìˆ˜ ìˆê³ , end-to-endë°©ì‹ 

ê¸°ì¡´ì˜ ë°©ë²•ë“¤ì€ siamese êµ¬ì¡°ë¥¼ í™œìš©í•´  queryì™€ supportê°„ì˜ relationì„ í•™ìŠµ í•˜ì˜€ìŒ. í•˜ì§€ë§Œ ì´ëŸ¬í•œ ë°©ë²•ì€ overfitting or computational costê°€ ë‚­ë¹„ë˜ì–´ì§ˆ ìˆ˜ ìˆìŒ. ë˜í•œ ë‹¨ìˆœí•œ multiplicationì„ í†µí•´ high-quality segmentation masksë¥¼ ìƒì„±í•˜ê¸°ëŠ” ë¶ˆì¶©ë¶„ í•¨. 

ê·¸ë˜ì„œ ë³¸ ë…¼ë¬¸ì—ì„œëŠ” Similarity Guidance Network for One-shot Semantic Segmentation(SG-One)ì„ ì œì•ˆ.

##### Problem Definition

$$L_{train} = \{(I_i, Y_i)\}^{N_{train}}_{i=1}$$
$$L_{support} = \{(I_i, Y_i)\}^{N_{support}}_{i=1}$$
$$I_i$$ : an image, $$Y_i$$ : corresponding segmentation mask

support setì™€ test setì€ train setê³¼ ì—°ê²°ë˜ì§€ ì•Šì€ ë™ì¼í•œ ìœ í˜•ì˜ ê°ì²´ë¥¼ ê³µìœ 
$$l \in Y$$ : semantic class 
$$K$$ annotated imageë©´ few-shot problem

query image $$I_i$$ ì— ëŒ€í•´ pair $$\{(I_i, Y_i), (I_j, Y_j)\}$$ 
$$\hat{Y}_j = f_\theta((I_i, Y_i), I_j)$$ 

* Masked Average Pooling
  for extracting the representative vectors of support objects
   $$ I \in R^{3\times w\times h}, Y \in \{0,1\}^{w\times h}$$ output feature $$F' \in R^{c\times w' \times h'}$$ 
  bilinear interpolation: resize the feature map to the same size $$Y$$ 
  $$i_{th}$$ element $$v_i$$ of the representative vector 
  $$v_i = {\sum_{x=1, y=1}^{w,h} Y_{x,y} * F_{i,x,y} \over \sum_{x=1, y=1}^{w,h} Y_{x,y}}$$ 
  feature mapì´ë‘ binary maskë‘ ê³±í•˜ê¸° ë•Œë¬¸ì— ë°°ê²½ì„ ë¬´ì‹œí•˜ê³  ê°ì²´ ì˜ì—­ì˜ featureë¥¼ ì¶”ì¶œí•  ìˆ˜ ìˆìŒ 
* Similarity Guidance 
  one-shot semantic segmentationì€ reference objectì˜ í•˜ë‚˜ì˜ support imgê°€ ì£¼ì–´ì§€ë©´ ì¿¼ë¦¬ ì´ë¯¸ì§€ ë‚´ì—ì„œ target objectë¥¼ segmentí•˜ëŠ” ê²ƒì„ 
  Masked Average Poolingì„ í†µí•´ representative vector $$v$$ ë¥¼ ì¶”ì¶œ 
  $$I^{que}, F^{que} \in R^{c\times w'\times h'}$$ 
  representative vectorì™€ $$F^{que}$$ ê°„ì˜ similarity ë¥¼ ì¸¡ì •
  $$s_{x,y} = {v * F_{x,y}^{que} \over ||{v}||_2 * ||{F_{x,y}^{que}}||_2}, s_{x,y} \in [-1, 1]$$ 
  similarity map $$S$$ëŠ” segmentation branch ì—ì„œ desired object regionì„ ë°œê²¬í•˜ëŠ” guidance ì—­í• ì„ í•¨ 

* Similarity Guidance Method 
  stem, similarity guidance branch, segmentation branch

  - Similarity Guidance Branch is fed the extracted features of both query and support images.
    similarity guidance mapsì€ query imgì˜ featureì— reference objectì˜ featureë¥¼ ì¡°í•©í•¨
    ê·¸ë¦¬ê³  Masked Average Poolingì„ í†µí•´ representative vectorë¥¼ ì–»ìŒ 
    qeury img ì˜ featureì— ëŒ€í•´ three blockì„ ê³¼ í•œ í›„ representative vectorì™€ consie similarity ë¥¼ êµ¬í•¨ 
  - Segmentation Branch
    similarity mapì„ í™œìš©í•˜ì—¬ query imgì— target object regionì„ ë°œê²¬í•˜ëŠ” ê²ƒì´ ëª©í‘œ




---
layout: post
title:  "Partial Convolution based Padding"
date:   2021-01-22 16:012:36 +0530
categories: paper
---



ê·¸ì „ì— ì •ë¦¬ í•´ë†“ì•˜ë˜ ê²ƒ ì˜¬ë¦¬ê¸° ğŸ¸



![img1](\assets\post\post4\img1.png)

zero paddingë³´ë‹¤ ì¢‹ì€ ì„±ëŠ¥ì˜ padding schemeì¸ partial convolution based paddingì„ ì œì•ˆ 

#### Introduction

* zero paddingì€ inputê³¼ ê´€ë ¨ì´ ì—†ìŒ
* Reflection and Replication paddingì€ ê·¸ëŸ´ë“¯í•œ ë°ì´í„°ì²˜ëŸ¼ ë³´ì´ì§€ë§Œ ì…ë ¥ì˜ ì¼ë¶€ë§Œì´ ë³µì œë˜ê¸° ë•Œë¬¸ì— ë¹„í˜„ì‹¤ì ì¸ ì´ë¯¸ì§€ íŒ¨í„´ì„ ë§Œë“¤ ìˆ˜ ìˆìŒ 
* ê¸°ì¡´ paddingë°©ë²•ë“¤ì€ original inputê³¼ ë™ë“±í•˜ê²Œ ë‹¤ë¤„ì§€ê¸° ë•Œë¬¸ì— ëª¨ë¸ì´ í˜¼ë€ìŠ¤ëŸ¬ìš¸ ìˆ˜ ìˆìŒ 
* ê·¸ë˜ì„œ ë…¼ë¬¸ì—ì„œëŠ” valid inputì˜ conv outputì„ í™œìš©í•œ padding ë°©ë²•ì„ ì œì•ˆí•¨
  missing dataì˜ ë¶€ë¶„ì„ ì±„ìš°ëŠ” í˜•ì‹ì˜ paddingë°©ë²•ì„ 
* ì œì•ˆí•˜ëŠ” paddingë°©ë²•ì€ ìˆ˜ë ´ì´ ë¹ ë¥´ê³  ê¸°ì¡´ì˜ paddingë°©ë²•ë“¤ ë³´ë‹¤ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆìŒ 
* ë‹¤ë¥¸ paddingë°©ë²•ê³¼ ë¹„êµí•˜ì—¬ ì¢‹ì€ ì„±ëŠ¥ì„ ëƒ„
* semantic segmentationì—ì„œë„ ì¢‹ì€ ì„±ëŠ¥ì„ ë‚´ê³  artifactë¥¼ ì—†ì• ì¤„ ìˆ˜ ìˆìŒ 

#### Formulation & Analysis

ë…¼ë¬¸ì—ì„œ ì œì•ˆí•˜ëŠ” paddingë°©ë²•ì€ partial convolutionì„ ê¸°ë°˜ìœ¼ë¡œ í•¨

**Partial Convolution **  

![img2](\assets\post\post4\img2.png)  

* Partial convolutionì€ incomplete input dataë¥¼ ë‹¤ë£¨ê¸° ìœ„í•´ ì œì•ˆë˜ì—ˆìŒ
* convê°€ ìœ íš¨í•œ í”½ì…€ì—ë§Œ ì ìš©ë˜ë„ë¡ ì œí•œí•˜ëŠ” maskingì„ ê±°ì¹˜ëŠ” ë°©ì‹
* maskë¥¼ í™œìš©í•˜ì—¬ convì—°ì‚°ì„ í• ìˆ˜ë¡ hole(maskì—ì„œ 0ì¸ ë¶€ë¶„)ì„ ì±„ìš°ëŠ” ì‹ìœ¼ë¡œ update
* ![img3](\assets\post\post4\img3.png)  ëŠ” ìœ íš¨í•œ í”½ì…€ì€ 1, ì•„ë‹Œ ë¶€ë¶„ì€ 0ì¸ binary mask
* ![img4](\assets\post\post4\img4.png) ì€ conví•  ë•Œ non holeì¸ ë¶€ë¶„ì´ ìˆìœ¼ë©´ ì—°ì‚°ì„ ì§„í–‰
* ![img5](\assets\post\post4\img5.png)ì€ scaling factorë¡œ ë§ˆìŠ¤í¬ê°€ê°€ ì“°ì´ì§€ ì•ŠëŠ” ìœ íš¨í•œ pixelì— ëŒ€í•´ì„œ í”½ì…€ì„ ì¡°ì •í•´ì£¼ëŠ” ì¼ì¢…ì˜ Normalizationê¸°ëŠ¥ì„ í•¨  
  ![img6](\assets\post\post4\img6.png)  
* convì—°ì‚°ì„ ì§„í–‰í• ìˆ˜ë¡ maskê°€ ì—…ë°ì´íŠ¸ ë˜ì–´ì§
* convolutionì´ ì ì–´ë„ í•˜ë‚˜ì˜ ìœ íš¨í•œ ì…ë ¥ ê°’ìœ¼ë¡œ ì¶œë ¥ì„ ì¡°ì •í•  ìˆ˜ ìˆë‹¤ë©´ í•´ë‹¹ ìœ„ì¹˜ë¥¼ ìœ íš¨í•˜ê²Œ í‘œí˜„í•˜ê¸° ë•Œë¬¸ì— maskê°€ 1ë¡œ ì—…ë°ì´íŠ¸ ë¨ 

**Partial Convolution based Padding**  
ê·¸ë˜ì„œ ë…¼ë¬¸ì—ì„œëŠ” ì´ëŸ¬í•œ partial convolutionì„ ì´ìš©í•œ paddingë°©ë²•ì„ ì œì•ˆí•¨  
![img7](\assets\post\post4\img7.png)  

* ì´ë¯¸ì§€ ë¶€ë¶„ì„ non-holeë¡œ, paddingë¶€ë¶„ì„ holeë¡œ ì •ì˜í•¨
* 1ì€ xì™€ í¬ê¸°ëŠ” ê°™ì€ 2D matixì´ì§€ë§Œ single channel
* ![img8](\assets\post\post4\img8.png)ëŠ” ![img9](\assets\post\post4\img9.png)ì˜ zero padding ìƒíƒœ
* ![img10](\assets\post\post4\img10.png)ì€ 1ì˜ zero padding ìƒíƒœ
* ìœ„ì™€ ê°™ì€ ì •ì˜ë¥¼ ì‚¬ìš©í•´ì„œ ë‚˜íƒ€ë‚¸ conv output  
  ![img11](\assets\post\post4\img11.png)
* zero paddingì€ special caseë¡œ r_(i,j)ê°€ 1ì´ ë¨
* ìµœì¢… formulation  
  ![img12](\assets\post\post4\img12.png)

**Case of Big Padding Size**

* ì´ë¯¸ì§€ë¥¼ ê· ì¼í•˜ê²Œ í¬ê¸° ì¡°ì •í•˜ê¸° ìœ„í•´ì„œ í° íŒ¨ë”©ì´ í•„ìš”í•œ ê²½ìš°ê°€ ìˆìŒ 
* íŒ¨ë”©ì— ì˜í•œ í¬ê¸° ì¡°ì •ì€ ë³´í†µ í¬ê¸° ì¡°ì •ìœ¼ë¡œ ì¸í•´ ì™œê³¡ì´ ë°œìƒí•  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì¼ë°˜ì ìœ¼ë¡œ ì„ í˜¸ë˜ì–´ì§
* ì´ëŸ´ ê²½ìš° original partial convolution formulationì„ ë”°ë¦„
* íŠ¹íˆ, ì²«ë²ˆì§¸ì˜ ë ˆì´ì–´ ê²½ìš° ![img13](\assets\post\post4\img13.png)ì˜ padded resultëŠ” ![img14](\assets\post\post4\img14.png)
  ì´í›„, ì´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ëŠ” output mask ![img15](\assets\post\post4\img15.png)ëŠ” equation3ë¥¼ ì´ìš©í•¨
* the input mask for n-th layer will be ![img16](\assets\post\post4\img16.png)

**Experiments**

 ![img17](\assets\post\post4\img17.png)

 ![img18](\assets\post\post4\img18.png)

 ![img19](\assets\post\post4\img19.png)





experimentsë¶€ë¶„ì„ ë„ˆë¬´ ëŒ€ì¶© ì½ì—ˆë˜ ë…¼ë¬¸... experimentë¶€ë¶„ë„ ì¤‘ìš”í•œë°... ì•ìœ¼ë¡œëŠ” ê¼¼ê¼¼íˆ ì½ì..ğŸ¤“

